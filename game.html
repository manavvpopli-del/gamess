<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe Premium</title>
<style>
*{box-sizing:border-box;font-family:Arial}
body{
margin:0;
background:radial-gradient(circle at top,#111,#000);
color:#fff;
display:flex;
align-items:center;
justify-content:center;
height:100vh;
overflow:hidden;
}
.screen{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column}
.hidden{display:none}
button{
padding:14px 30px;
margin:10px;
font-size:18px;
border:none;
border-radius:10px;
cursor:pointer;
background:#00ffc6;
color:#000;
font-weight:bold;
transition:.3s;
}
button:hover{transform:scale(1.1)}
#board{
display:grid;
grid-template-columns:repeat(3,120px);
gap:15px;
}
.cell{
width:120px;height:120px;
background:rgba(255,255,255,.05);
backdrop-filter:blur(10px);
display:flex;
align-items:center;
justify-content:center;
font-size:70px;
cursor:pointer;
border-radius:15px;
transition:.3s;
}
.cell:hover{background:rgba(255,255,255,.15)}
.win{background:#00ff88!important;animation:pulse .5s infinite alternate}
@keyframes pulse{from{transform:scale(1)}to{transform:scale(1.08)}}
#result{
font-size:40px;
margin-bottom:20px;
animation:fade .6s;
}
@keyframes fade{from{opacity:0;transform:scale(.8)}to{opacity:1}}
</style>
</head>

<body>

<audio id="bg" loop src="bg.mp3"></audio>

<!-- CONTINUE -->
<div id="start" class="screen">
<h1>TIC TAC TOE</h1>
<button onclick="startGame()">DAVAM ET</button>
</div>

<!-- MODE -->
<div id="mode" class="screen hidden">
<h2>Rejimi seç</h2>
<button onclick="setMode('pvp')">2 Nəfər</button>
<button onclick="setMode('bot')">Bot</button>
</div>

<!-- BOT LEVEL -->
<div id="level" class="screen hidden">
<h2>Bot Səviyyəsi</h2>
<button onclick="setLevel('easy')">Easy</button>
<button onclick="setLevel('normal')">Normal</button>
<button onclick="setLevel('hard')">Hard</button>
</div>

<!-- GAME -->
<div id="game" class="screen hidden">
<div id="board"></div>
</div>

<!-- RESULT -->
<div id="end" class="screen hidden">
<div id="result"></div>
<button onclick="restart()">Yenidən</button>
</div>

<script>
const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
let board,turn,mode,level;

const screens={start,modeScr:mode,levelScr:level,game,end};

function show(s){
document.querySelectorAll('.screen').forEach(e=>e.classList.add('hidden'));
s.classList.remove('hidden');
}

function startGame(){
document.getElementById("bg").play();
show(mode);
}

function setMode(m){
mode=m;
m==='bot'?show(level):init();
}

function setLevel(l){
level=l;
init();
}

function init(){
board=Array(9).fill("");
turn="X";
draw();
show(game);
}

function draw(){
boardDiv.innerHTML="";
board.forEach((v,i)=>{
const d=document.createElement("div");
d.className="cell";
d.textContent=v;
d.onclick=()=>move(i);
boardDiv.appendChild(d);
});
}

function move(i){
if(board[i]||check())return;
board[i]=turn;
draw();
if(check()){endGame(turn);return;}
if(!board.includes("")){endGame("draw");return;}
turn=turn==="X"?"O":"X";
if(mode==="bot"&&turn==="O")setTimeout(botMove,300);
}

function botMove(){
let i;
if(level==="easy")i=random();
else if(level==="normal")i=Math.random()<.5?random():best();
else i=best();
board[i]="O";
draw();
if(check())endGame("O");
else if(!board.includes(""))endGame("draw");
else turn="X";
}

function random(){
return board.map((v,i)=>v===""?i:null).filter(v=>v!==null)
[Math.floor(Math.random()*board.filter(v=>v==="").length)];
}

function best(){
let best=-1e9,move;
for(let i=0;i<9;i++){
if(board[i]===""){
board[i]="O";
let s=minimax(board,0,false);
board[i]="";
if(s>best){best=s;move=i;}
}}
return move;
}

function minimax(b,d,isMax){
if(win(b,"O"))return 10-d;
if(win(b,"X"))return d-10;
if(!b.includes(""))return 0;
let best=isMax?-1e9:1e9;
for(let i=0;i<9;i++){
if(b[i]===""){
b[i]=isMax?"O":"X";
best=isMax?Math.max(best,minimax(b,d+1,false))
:Math.min(best,minimax(b,d+1,true));
b[i]="";
}}
return best;
}

function win(b,p){return wins.some(w=>w.every(i=>b[i]===p));}
function check(){return win(board,"X")||win(board,"O");}

function endGame(r){
show(end);
result.textContent=r==="draw"?"HEÇ-HEÇƏ":r+" QAZANDI!";
}

function restart(){show(mode);}
</script>
</body>
</html>