<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XOXO Premium</title>

<style>
:root{
    --main:#ff4fd8;
    --x:#00f7ff;
    --bg1:#2b0040;
    --bg2:#000;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,sans-serif}

body{
    width:100vw;height:100vh;
    background:radial-gradient(circle at top,var(--bg1),var(--bg2));
    display:flex;
    justify-content:center;
    align-items:center;
    color:white;
}

/* MENU */
.menu{
    background:rgba(0,0,0,.65);
    padding:35px;
    border-radius:30px;
    box-shadow:0 0 50px var(--main);
    text-align:center;
}

.menu h1{
    font-size:52px;
    color:var(--main);
    text-shadow:0 0 25px var(--main);
}

.menu button,select{
    width:240px;
    margin:12px;
    padding:14px;
    font-size:18px;
    border:none;
    border-radius:25px;
    cursor:pointer;
    font-weight:bold;
}

.menu button{
    background:var(--main);
}

.game{
    display:none;
    flex-direction:column;
    align-items:center;
}

.board{
    display:grid;
    grid-template-columns:repeat(3,110px);
    gap:15px;
    margin:25px 0;
}

.cell{
    height:110px;
    border-radius:20px;
    background:rgba(255,255,255,.06);
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:60px;
    cursor:pointer;
}

.cell.X{color:var(--x);text-shadow:0 0 20px var(--x)}
.cell.O{color:var(--main);text-shadow:0 0 20px var(--main)}

#status{font-size:20px;margin:10px}

.back{
    background:#444;
    color:white;
}
</style>
</head>

<body>

<!-- MENU -->
<div class="menu" id="menu">
    <h1>XOXO</h1>

    <button onclick="startGame('local')">üë• 2 N…ôf…ôr</button>

    <select id="botLevel">
        <option value="easy">ü§ñ Asan Bot</option>
        <option value="normal">ü§ñ Normal Bot</option>
        <option value="hard">ü§ñ √á…ôtin Bot</option>
    </select>
    <button onclick="startGame('bot')">Botla Oyna</button>

    <select onchange="setTheme(this.value)">
        <option value="purple">üíú Purple</option>
        <option value="blue">üíô Blue</option>
        <option value="red">‚ù§Ô∏è Red</option>
    </select>
</div>

<!-- GAME -->
<div class="game" id="game">
    <div id="status">X ba≈ülayƒ±r</div>
    <div class="board" id="board"></div>
    <button onclick="reset()">Yenid…ôn</button>
    <button class="back" onclick="backMenu()">Menyu</button>
</div>

<script>
let board,turn,mode,botLevel;
const winCombos=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

const menu=document.getElementById("menu");
const game=document.getElementById("game");
const boardEl=document.getElementById("board");
const statusEl=document.getElementById("status");

function startGame(m){
    mode=m;
    botLevel=document.getElementById("botLevel").value;
    menu.style.display="none";
    game.style.display="flex";
    reset();
}

function reset(){
    board=Array(9).fill("");
    turn="X";
    draw();
}

function draw(){
    boardEl.innerHTML="";
    board.forEach((v,i)=>{
        const c=document.createElement("div");
        c.className="cell "+v;
        c.innerText=v;
        c.onclick=()=>play(i);
        boardEl.appendChild(c);
    });
    statusEl.innerText=turn+" n√∂vb…ôd…ôdir";
}

function play(i){
    if(board[i] || checkWin()) return;
    board[i]=turn;
    turn=turn=="X"?"O":"X";
    draw();

    if(mode=="bot" && turn=="O"){
        setTimeout(botMove,500);
    }
}

function botMove(){
    let move;
    if(botLevel=="easy"){
        move=randomMove();
    }else if(botLevel=="normal"){
        move=winMove("O") ?? randomMove();
    }else{
        move=minimax(board,"O").index;
    }
    board[move]="O";
    turn="X";
    draw();
}

function randomMove(){
    const empty=board.map((v,i)=>v==""?i:null).filter(v=>v!=null);
    return empty[Math.floor(Math.random()*empty.length)];
}

function winMove(p){
    for(let c of winCombos){
        const vals=c.map(i=>board[i]);
        if(vals.filter(v=>v==p).length==2 && vals.includes("")){
            return c[vals.indexOf("")];
        }
    }
    return null;
}

function minimax(b,p){
    if(check("X",b)) return {score:-10};
    if(check("O",b)) return {score:10};
    if(!b.includes("")) return {score:0};

    let moves=[];
    b.forEach((v,i)=>{
        if(v==""){
            let copy=[...b];
            copy[i]=p;
            let score=minimax(copy,p=="O"?"X":"O").score;
            moves.push({index:i,score});
        }
    });

    return p=="O"
        ? moves.reduce((a,b)=>b.score>a.score?b:a)
        : moves.reduce((a,b)=>b.score<a.score?b:a);
}

function check(p,b=board){
    return winCombos.some(c=>c.every(i=>b[i]==p));
}

function checkWin(){
    if(check("X")){alert("X qazandƒ±");return true;}
    if(check("O")){alert("O qazandƒ±");return true;}
    return false;
}

function backMenu(){
    game.style.display="none";
    menu.style.display="block";
}

/* THEMES */
function setTheme(t){
    if(t=="purple") document.documentElement.style.cssText="--main:#ff4fd8;--x:#00f7ff;--bg1:#2b0040";
    if(t=="blue") document.documentElement.style.cssText="--main:#00f7ff;--x:#fff;--bg1:#002b40";
    if(t=="red") document.documentElement.style.cssText="--main:#ff2e2e;--x:#fff;--bg1:#400000";
}
</script>

</body>
</html>