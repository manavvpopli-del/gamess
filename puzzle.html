<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<title>Puzzle Oyunu</title>
<style>
html, body {
    margin:0;
    padding:0;
    width:100%;
    height:100%;
    overflow:hidden;
    display:flex;
    justify-content:center;
    align-items:center;
    background:#111;
    font-family:Arial, sans-serif;
}

#puzzle-container {
    display:grid;
    grid-template-columns:repeat(4,1fr);
    grid-template-rows:repeat(4,1fr);
    gap:2px;
    width:90vmin;
    height:90vmin;
    position:relative;
    background:#222;
}

.piece {
    width:100%;
    height:100%;
    background-image:url('image.jpg');
    background-size:400% 400%;
    cursor:grab;
    user-select:none;
    position:relative;
    transition: transform 0.2s;
}

.piece.correct {
    cursor:default;
    box-shadow:0 0 10px lime;
}

#message {
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:5vmin;
    color:lime;
    display:none;
    z-index:100;
}
</style>
</head>
<body>

<div id="puzzle-container"></div>
<div id="message">HalaldÄ±!</div>

<script>
const rows = 4;
const cols = 4;
const container = document.getElementById('puzzle-container');
const message = document.getElementById('message');

let pieces = [];

// Generate pieces
for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
        const div = document.createElement('div');
        div.classList.add('piece');
        div.dataset.row = r;
        div.dataset.col = c;
        div.style.backgroundPosition = `${-c*100/(cols-1)}% ${-r*100/(rows-1)}%`;
        pieces.push(div);
    }
}

// Shuffle positions
function shuffle(array){
    for(let i=array.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [array[i],array[j]] = [array[j],array[i]];
    }
    return array;
}
pieces = shuffle(pieces);

// Append shuffled pieces to grid
pieces.forEach(p=>{
    container.appendChild(p);
});

// Drag & drop logic
let dragging = null;
let startIndex = null;

pieces.forEach((p,i)=>{
    p.addEventListener('pointerdown', e=>{
        if(p.classList.contains('correct')) return;
        dragging = p;
        startIndex = i;
        p.setPointerCapture(e.pointerId);
        p.style.zIndex=100;
    });

    p.addEventListener('pointermove', e=>{
        if(dragging!==p) return;
        dragging.style.transform = `translate(${e.movementX}px, ${e.movementY}px)`;
    });

    p.addEventListener('pointerup', e=>{
        if(dragging!==p) return;
        dragging.style.transform='';

        // Swap only if wrong position
        const target = document.elementFromPoint(e.clientX, e.clientY);
        if(target && target.classList.contains('piece') && target!==dragging){
            const dragPos = Array.from(container.children).indexOf(dragging);
            const targetPos = Array.from(container.children).indexOf(target);
            container.insertBefore(dragging, targetPos>dragPos?target.nextSibling:target);
        }

        // Check correct placement
        pieces.forEach((piece,j)=>{
            const row = Math.floor(j/cols);
            const col = j%cols;
            if(piece.dataset.row==row && piece.dataset.col==col){
                piece.classList.add('correct');
            }else{
                piece.classList.remove('correct');
            }
        });

        checkWin();
        dragging.releasePointerCapture(e.pointerId);
        dragging.style.zIndex=1;
        dragging=null;
    });
});

function checkWin(){
    const allCorrect = pieces.every(p=>p.classList.contains('correct'));
    if(allCorrect){
        message.style.display='block';
    }
}
</script>

</body>
</html>