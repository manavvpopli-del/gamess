<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<title>Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    user-select:none;
    touch-action:none;
}
html,body{
    width:100%;
    height:100%;
    overflow:hidden;
    background:#0a0a0a;
    font-family:Arial,Helvetica,sans-serif;
}

/* GAME */
#game{
    position:fixed;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
}

/* BOARD */
#board{
    position:relative;
    width:80vmin;
    height:80vmin;
    background:#111;
    border-radius:20px;
    box-shadow:0 0 40px rgba(255,0,120,.5);
}

/* SLOT */
.slot{
    position:absolute;
    border:2px dashed rgba(255,255,255,.15);
}

/* PIECES AREA */
#pieces{
    margin-top:20px;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
}

/* PIECE */
.piece{
    width:26vmin;
    height:26vmin;
    max-width:120px;
    max-height:120px;
    background-size:cover;
    border-radius:8px;
    cursor:grab;
    box-shadow:0 10px 25px rgba(0,0,0,.6);
}

.piece.locked{
    cursor:default;
    box-shadow:0 0 25px rgba(0,255,150,.9);
}

/* WIN */
#win{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.9);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:10;
}

#win h1{
    color:white;
    font-size:64px;
    text-shadow:0 0 30px #ff2e9a;
    animation:pulse 1.5s infinite;
}

@keyframes pulse{
    0%{transform:scale(1)}
    50%{transform:scale(1.1)}
    100%{transform:scale(1)}
}
</style>
</head>
<body>

<div id="game">
    <div id="board"></div>
    <div id="pieces"></div>
</div>

<div id="win">
    <h1>ðŸŽ‰ Puzzle Bitdi!</h1>
</div>

<img id="img" src="image.jpg" hidden>

<script>
const ROWS=3, COLS=3;
const board=document.getElementById("board");
const piecesBox=document.getElementById("pieces");
const img=document.getElementById("img");
let lockedCount=0;

img.onload=init;

function init(){
    const size=board.clientWidth;
    const pw=size/COLS;
    const ph=size/ROWS;

    // create slots
    for(let y=0;y<ROWS;y++){
        for(let x=0;x<COLS;x++){
            const s=document.createElement("div");
            s.className="slot";
            s.style.width=pw+"px";
            s.style.height=ph+"px";
            s.style.left=x*pw+"px";
            s.style.top=y*ph+"px";
            board.appendChild(s);
        }
    }

    // piece order shuffled
    let order=[...Array(ROWS*COLS).keys()];
    order.sort(()=>Math.random()-0.5);

    order.forEach(i=>{
        const x=i%COLS;
        const y=Math.floor(i/COLS);

        const p=document.createElement("div");
        p.className="piece";
        p.dataset.index=i;
        p.style.backgroundImage="url(image.jpg)";
        p.style.backgroundSize=`${size}px ${size}px`;
        p.style.backgroundPosition=`-${x*pw}px -${y*ph}px`;

        enableDrag(p,pw,ph);
        piecesBox.appendChild(p);
    });
}

function enableDrag(el,pw,ph){
    let dx,dy;

    el.addEventListener("pointerdown",e=>{
        if(el.classList.contains("locked")) return;
        dx=e.clientX-el.getBoundingClientRect().left;
        dy=e.clientY-el.getBoundingClientRect().top;
        el.style.position="fixed";
        el.style.zIndex=5;
    });

    el.addEventListener("pointermove",e=>{
        if(el.classList.contains("locked")) return;
        el.style.left=e.clientX-dx+"px";
        el.style.top=e.clientY-dy+"px";
    });

    el.addEventListener("pointerup",e=>{
        if(el.classList.contains("locked")) return;

        const i=+el.dataset.index;
        const slot=board.children[i];
        const r1=el.getBoundingClientRect();
        const r2=slot.getBoundingClientRect();

        const ok=Math.abs(r1.left-r2.left)<25 &&
                 Math.abs(r1.top-r2.top)<25;

        if(ok){
            el.classList.add("locked");
            el.style.left=r2.left+"px";
            el.style.top=r2.top+"px";
            el.style.width=r2.width+"px";
            el.style.height=r2.height+"px";
            el.style.position="fixed";
            lockedCount++;

            if(lockedCount===ROWS*COLS){
                document.getElementById("win").style.display="flex";
            }
        }else{
            // geri alt hissÉ™yÉ™
            el.style.position="static";
        }
    });
}
</script>

</body>
</html>