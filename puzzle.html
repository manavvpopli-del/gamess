<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<title>Puzzle Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    touch-action:none;
    user-select:none;
}
html,body{
    width:100%;
    height:100%;
    overflow:hidden;
    background:#0b0b0b;
    font-family:Arial,Helvetica,sans-serif;
}

#game{
    position:fixed;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
}

#board{
    position:relative;
    width:90vmin;
    height:90vmin;
    background:#111;
    border-radius:20px;
    box-shadow:0 0 40px rgba(255,0,120,.4);
}

.slot{
    position:absolute;
    border:2px dashed rgba(255,255,255,.15);
}

.piece{
    position:absolute;
    cursor:grab;
    border-radius:6px;
    box-shadow:0 10px 25px rgba(0,0,0,.6);
    transition:.25s;
}

.piece.locked{
    cursor:default;
    box-shadow:0 0 30px rgba(0,255,150,.9);
}

.highlight{
    position:absolute;
    border-radius:6px;
    background:rgba(0,255,150,0.3);
    pointer-events:none;
    z-index:0;
}

#win{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.85);
    display:none;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    z-index:10;
}

#win h1{
    font-size:64px;
    color:#fff;
    text-shadow:0 0 30px #ff2e9a;
    animation:pulse 1.4s infinite;
}

@keyframes pulse{
    0%{transform:scale(1)}
    50%{transform:scale(1.1)}
    100%{transform:scale(1)}
}
</style>
</head>
<body>

<div id="game">
    <div id="board"></div>
</div>

<div id="win">
    <h1>ðŸŽ‰ Puzzle Bitdi!</h1>
</div>

<img id="img" src="image.jpg" hidden>

<script>
const ROWS = 3;
const COLS = 3;

const board = document.getElementById("board");
const img = document.getElementById("img");
let placed = 0;

img.onload = () => init();

function init(){
    const size = board.clientWidth;
    const pw = size / COLS;
    const ph = size / ROWS;

    // slots
    let slots = [];
    for(let y=0;y<ROWS;y++){
        for(let x=0;x<COLS;x++){
            const s = document.createElement("div");
            s.className="slot";
            s.style.width=pw+"px";
            s.style.height=ph+"px";
            s.style.left=x*pw+"px";
            s.style.top=y*ph+"px";
            board.appendChild(s);
            slots.push(s);
        }
    }

    // pieces
    let indices=[...Array(ROWS*COLS).keys()];
    indices.sort(()=>Math.random()-0.5);

    // BaÅŸlanÄŸÄ±cda parÃ§alarÄ± boardun saÄŸÄ±nda sÉ™liqÉ™li ÅŸÉ™kildÉ™ dÃ¼z
    let startLeft = window.innerWidth - pw*COLS - 30;
    let startTop = 50;
    let margin = 10;

    indices.forEach((i,idx)=>{
        const x=i%COLS;
        const y=Math.floor(i/COLS);

        const p=document.createElement("div");
        p.className="piece";
        p.dataset.index=i;
        p.style.width=pw+"px";
        p.style.height=ph+"px";
        p.style.background=`url(image.jpg)`;
        p.style.backgroundSize=`${size}px ${size}px`;
        p.style.backgroundPosition=`-${x*pw}px -${y*ph}px`;

        // Start position kÉ™narda
        p.style.left = startLeft + (idx % COLS)*(pw+margin) + "px";
        p.style.top = startTop + Math.floor(idx / COLS)*(ph+margin) + "px";

        // Highlight É™lavÉ™ et
        const hl = document.createElement("div");
        hl.className="highlight";
        hl.style.width = pw + "px";
        hl.style.height = ph + "px";
        hl.style.left = x*pw + "px";
        hl.style.top = y*ph + "px";
        board.appendChild(hl);

        drag(p,pw,ph,slots,hl);
        document.body.appendChild(p);
    });
}

function drag(el,pw,ph,slots,hl){
    let dx,dy;

    el.addEventListener("pointerdown",e=>{
        if(el.classList.contains("locked")) return;
        dx=e.clientX-el.offsetLeft;
        dy=e.clientY-el.offsetTop;
        el.setPointerCapture(e.pointerId);
        el.style.zIndex=5;
        hl.style.display="block";
    });

    el.addEventListener("pointermove",e=>{
        if(!el.hasPointerCapture(e.pointerId)) return;
        el.style.left=e.clientX-dx+"px";
        el.style.top=e.clientY-dy+"px";
    });

    el.addEventListener("pointerup",e=>{
        el.releasePointerCapture(e.pointerId);
        el.style.zIndex=1;
        hl.style.display="none";

        const i=+el.dataset.index;
        const slot=slots[i];
        const r1=el.getBoundingClientRect();
        const r2=slot.getBoundingClientRect();

        // Tam dÃ¼zgÃ¼n yerinÉ™ qoy
        if(Math.abs(r1.left - r2.left)<1 && Math.abs(r1.top - r2.top)<1){
            el.style.left = r2.left + "px";
            el.style.top = r2.top + "px";
            el.classList.add("locked");
            placed++;
            if(placed===ROWS*COLS){
                document.getElementById("win").style.display="flex";
            }
        }
    });
}
</script>

</body>
</html>