<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sevgilini N…ô Q…ôd…ôr Tanƒ±yƒ±rsan?</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      color: #f0e0ff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      overflow-x: hidden;
    }
    #bg-video {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      z-index: -2;
    }
    #overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      z-index: -1;
    }
    h1 { 
      font-size: clamp(2.8rem, 8vw, 4.5rem); 
      margin: 10vh 0 4vh; 
      color: #ff66cc; 
      text-shadow: 0 0 20px #ff66ccaa; 
      z-index: 1;
      text-align: center;
    }
    #start-screen {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      background: rgba(0,0,0,0.3);
    }
    #start-btn {
      font-size: 2.2rem;
      padding: 1rem 4rem;
      background: linear-gradient(135deg, #ff3366, #ff66cc, #cc33ff);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(255, 51, 102, 0.5);
      transition: all 0.4s ease;
      animation: pulse 2s infinite;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: bold;
    }
    #start-btn:hover {
      transform: scale(1.08) translateY(-5px);
      box-shadow: 0 15px 40px rgba(255, 51, 102, 0.7);
      background: linear-gradient(135deg, #ff66cc, #cc33ff, #9933ff);
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 51, 102, 0.7); }
      70% { box-shadow: 0 0 0 20px rgba(255, 51, 102, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 51, 102, 0); }
    }
    #status {
      font-size: clamp(1.4rem, 5vw, 2rem);
      margin: 3vh 0 5vh;
      color: #ffcc66;
      text-align: center;
      max-width: 90%;
      z-index: 1;
    }
    #lobby { 
      text-align: center; 
      width: 100%; 
      max-width: 520px; 
      z-index: 1; 
      display: none;
    }
    input, button {
      font-size: 1.4rem;
      padding: 1rem 2rem;
      margin: 1.2rem 0.6rem;
      border: none;
      border-radius: 14px;
      width: 100%;
      max-width: 400px;
    }
    button {
      background: #ff33cc;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
    }
    button:hover { background: #ff1ab3; transform: translateY(-4px); }
    #copyBtn { background: #00cc88; }
    #copyBtn:hover { background: #00ffaa; }

    #game {
      display: none;
      width: 100%;
      max-width: 1100px;
      flex-direction: column;
      align-items: center;
      padding: 3vh 0;
      z-index: 1;
    }
    #timer {
      font-size: clamp(5rem, 14vw, 7rem);
      font-weight: bold;
      color: #ff3366;
      margin: 3vh 0;
      text-shadow: 0 0 20px #ff3366aa;
    }
    #qEmoji { font-size: clamp(6rem, 18vw, 9rem); margin: 3vh 0; }
    #question {
      font-size: clamp(1.8rem, 6vw, 2.8rem);
      text-align: center;
      line-height: 1.45;
      margin: 4vh 0 6vh;
      max-width: 90%;
    }
    .options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2.5vh;
      width: 100%;
      max-width: 1000px;
    }
    .option {
      background: rgba(60,0,110,0.8);
      padding: 3vh 5vw;
      border-radius: 18px;
      font-size: clamp(1.3rem, 4.5vw, 1.8rem);
      cursor: pointer;
      transition: all 0.35s ease;
      border: 3px solid transparent;
      text-align: center;
      backdrop-filter: blur(6px);
    }
    .option:hover {
      background: rgba(100,0,160,0.95);
      transform: translateY(-8px);
      border-color: #ff99ff;
    }
    .option.selected {
      border-color: #00ffcc;
      background: rgba(0,80,60,0.75);
    }
    #end {
      display: none;
      width: 100%;
      max-width: 1000px;
      flex-direction: column;
      align-items: center;
      padding: 5vh 0;
      z-index: 1;
    }
    #end h2 { 
      font-size: clamp(3rem, 8vw, 4.2rem); 
      color: #ffdd44; 
      margin-bottom: 4vh; 
      text-shadow: 0 0 15px #ffdd44aa;
    }
    #result { 
      font-size: clamp(1.8rem, 5.5vw, 2.4rem); 
      text-align: center; 
      margin-bottom: 5vh; 
      color: #ffcc66;
    }
    #answersList {
      width: 100%;
      max-width: 900px;
      background: linear-gradient(135deg, rgba(40,0,70,0.85), rgba(60,0,100,0.85));
      border-radius: 24px;
      padding: 5vh 4vw;
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      line-height: 1.9;
      margin-bottom: 5vh;
      border: 2px solid rgba(255, 102, 204, 0.3);
      box-shadow: 0 10px 40px rgba(255, 51, 102, 0.3);
      backdrop-filter: blur(10px);
    }
    #answersList h3 {
      text-align: center;
      color: #ff66cc;
      font-size: 1.8rem;
      margin-bottom: 3vh;
      text-shadow: 0 0 10px #ff66cc80;
    }
    #answersList div {
      margin: 3vh 0;
      padding: 3vh 4vw;
      background: rgba(80,0,120,0.6);
      border-radius: 16px;
      border-left: 6px solid #ff66cc;
      transition: all 0.3s;
    }
    #answersList div:hover {
      transform: translateX(8px);
      box-shadow: 0 8px 25px rgba(255, 102, 204, 0.4);
    }
    #answersList strong {
      color: #ffcc66;
    }
    button#restartBtn, button#shareResultImage {
      font-size: 1.5rem;
      padding: 1.2rem 3rem;
      margin: 1vh;
    }
    #shareResultImage { 
      background: linear-gradient(135deg, #ff3366, #ff6699); 
    }
    #shareResultImage:hover { 
      background: linear-gradient(135deg, #ff6699, #ff99cc); 
      transform: translateY(-4px);
    }
    #waiting { font-size: 1.5rem; color: #ffcc66; margin-top: 3vh; text-align: center; }
  </style>
</head>
<body>

  <video id="bg-video" autoplay loop playsinline muted>
    <source src="videoo.mp4" type="video/mp4">
  </video>
  <div id="overlay"></div>

  <audio id="bg-music" loop>
    <source src="musiic.mp3" type="audio/mpeg">
  </audio>

  <div id="start-screen">
    <h1>Sevgilini N…ô Q…ôd…ôr Tanƒ±yƒ±rsan?</h1>
    <button id="start-btn">Davam et</button>
  </div>

  <div id="status" style="display:none;">Hazƒ±rlanƒ±r...</div>

  <div id="lobby">
    <button onclick="createHost()">KOD Yarat</button>
    <input id="peerIdInput" placeholder="Qar≈üƒ± T…ôr…ôfin Kodunu Yaz" />
    <button onclick="joinGame()">Qo≈üul</button>
  </div>

  <div id="game">
    <div id="timer">15</div>
    <div id="qEmoji"></div>
    <div id="question"></div>
    <div class="options" id="options"></div>
  </div>

  <div id="end">
    <h2>Oyun Bitdi!</h2>
    <div id="result">30 sual cavablandƒ±!</div>
    <div id="answersList"></div>
    <button id="shareResultImage">N…ôtic…ôni payla≈ü (≈ü…ôkil)</button>
    <button id="restartBtn" onclick="requestRestart()">Yenid…ôn Ba≈ülat</button>
    <div id="waiting"></div>
  </div>

  <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    const status = document.getElementById('status');
    const startScreen = document.getElementById('start-screen');
    const lobby = document.getElementById('lobby');
    const gameDiv = document.getElementById('game');
    const startBtn = document.getElementById('start-btn');
    const timerEl = document.getElementById('timer');
    const qEmoji = document.getElementById('qEmoji');
    const questionEl = document.getElementById('question');
    const optionsEl = document.getElementById('options');
    const endDiv = document.getElementById('end');
    const resultEl = document.getElementById('result');
    const answersList = document.getElementById('answersList');
    const waitingEl = document.getElementById('waiting');
    const music = document.getElementById('bg-music');

    let peer = null;
    let conn = null;
    let myRole = null;
    let myId = '';
    let currentQuestionIndex = -1;
    let timerInterval = null;
    let timeLeft = 15;
    let myAnswered = false;
    let opponentAnswered = false;
    let myAnswers = new Array(30).fill(-1);
    let restartRequested = false;
    let opponentRestartRequested = false;

    const questions = [
      { q: "Sevgilinin …ôn sevdiyi r…ông hansƒ±dƒ±r?", options: ["A) Qƒ±rmƒ±zƒ± ‚Äì ehtiraslƒ± v…ô c…ôsar…ôtli", "B) Mavi ‚Äì sakit v…ô d…ôrin", "C) Ya≈üƒ±l ‚Äì t…ôbi…ôt v…ô harmoniya", "D) Sarƒ± ‚Äì g√ºn…ô≈ü kimi parlaq v…ô enerjili", "E) B…ôn√∂v≈ü…ôyi ‚Äì sirli v…ô krali√ßa kimi", "F) Qara ‚Äì gizemli v…ô seksiy"], emoji: "üé®" },
      { q: "U≈üaqlƒ±qda …ôn √ßox sevdiyi oyuncaq n…ô idi?", options: ["A) Ayƒ± balasƒ± ‚Äì qucaqlayƒ±b yatardƒ±", "B) Ma≈üƒ±n ‚Äì b√ºt√ºn evi yarƒ±≈ü meydanƒ± edirdi", "C) Kukla ‚Äì ona sa√ß d√ºz…ôldirdi", "D) Lego ‚Äì saatlarla tikib s√∂k√ºrd√º", "E) Top ‚Äì h…ôr yerd…ô oynayƒ±rdƒ±", "F) Robot ‚Äì onu idar…ô etm…ôyi sevirdi"], emoji: "üß∏" },
      { q: "∆èn sevdiyi yem…ôk hansƒ±dƒ±r?", options: ["A) Plov ‚Äì anasƒ±nƒ±n plovu …ôv…ôzedilm…ôz", "B) Pizza ‚Äì gec…ôl…ôr …ôn yax≈üƒ± dostu", "C) Dolma ‚Äì ail…ô yem…ôyi, emosional", "D) Lava≈ü ‚Äì h…ôr ≈üey…ô yara≈üƒ±r", "E) Kabab ‚Äì odun qoxusu il…ô", "F) Sushi ‚Äì z√∂vql√º v…ô ekzotik"], emoji: "üç≤" },
      { q: "S…ôh…ôr tezd…ôn ilk n…ô edir?", options: ["A) Telefonuna baxƒ±r ‚Äì ilk i≈ü sosial media", "B) Kofe/√ßay i√ßir ‚Äì g√ºn…ô onsuz ba≈ülamaz", "C) ƒ∞dman edir ‚Äì enerjini bo≈üaldƒ±r", "D) Yenid…ôn yatƒ±r ‚Äì s…ôh…ôr onun d√º≈üm…ônidir", "E) Du≈ü alƒ±r ‚Äì t…ôz…ôlik vacibdir", "F) Kitab oxuyur ‚Äì g√ºn…ô intellektl…ô ba≈ülayƒ±r"], emoji: "‚òï" },
      { q: "∆èn √ßox sevdiyi musiqi janrƒ± hansƒ±dƒ±r?", options: ["A) Pop ‚Äì h…ôr yerd…ô oxuyur", "B) Rap ‚Äì s√∂zl…ôr…ô vurulub", "C) Rock ‚Äì emosiyanƒ± bo≈üaldƒ±r", "D) Klassik ‚Äì ruhu sakitl…ô≈üdirir", "E) Xalq musiqisi ‚Äì k√∂kl…ôr…ô baƒülƒ±dƒ±r", "F) Elektronika ‚Äì gec…ôl…ôr…ô uyƒüundur"], emoji: "üéµ" },
      { q: "U≈üaqlƒ±q l…ôq…ôbi n…ô olub?", options: ["A) Balaca ‚Äì h…ômi≈ü…ô ki√ßik qalƒ±rdƒ±", "B) ≈ûirin ‚Äì hamƒ± qucaqlayƒ±rdƒ±", "C) T√ºlk√º ‚Äì hiyl…ôg…ôr idi", "D) √ñz√ºn…ôm…ôxsus l…ôq…ôbi olub", "E) Yaramaz ‚Äì evd…ô ba≈üƒ±-ba≈üƒ±na qalƒ±rdƒ±", "F) He√ß l…ôq…ôbi olmayƒ±b ‚Äì ciddi u≈üaq idi"], emoji: "üòÑ" },
      { q: "∆èn b√∂y√ºk qorxusu n…ôdir?", options: ["A) H√ºnd√ºrl√ºk ‚Äì damdan a≈üaƒüƒ± baxa bilmir", "B) Qaranlƒ±q ‚Äì i≈üƒ±q s√∂n…ônd…ô panika olur", "C) H√∂r√ºm√ß…ôk ‚Äì g√∂r…ônd…ô qƒ±≈üqƒ±rƒ±r", "D) T…ôk qalmaq ‚Äì yalnƒ±lƒ±qdan qorxur", "E) ƒ∞yn…ô ‚Äì h…ôkim…ô getm…ôkd…ôn yayƒ±nƒ±r", "F) D…ôniz ‚Äì d…ôrin sudan qorxur"], emoji: "üò±" },
      { q: "∆èn sevdiyi film janrƒ± hansƒ±dƒ±r?", options: ["A) Komediya ‚Äì g√ºl√º≈ü vacibdir", "B) Romantika ‚Äì sevgi hekay…ôl…ôrin…ô inanƒ±r", "C) Dram ‚Äì emosional filml…ôri sevir", "D) Aksiya ‚Äì adrenalin vurur", "E) Fantastika ‚Äì x…ôyallara qa√ßƒ±r", "F) D…ôh≈ü…ôt ‚Äì qorxunu sevir"], emoji: "üé¨" },
      { q: "∆èn √ßox sevdiyi m√∂vs√ºm hansƒ±dƒ±r?", options: ["A) Yay ‚Äì d…ôniz, g√ºn…ô≈ü, istirah…ôt", "B) Payƒ±z ‚Äì yarpaqlar v…ô romantika", "C) Qƒ±≈ü ‚Äì qar v…ô isti yorƒüan", "D) Yaz ‚Äì t…ôz…ôlik v…ô √ßi√ß…ôkl…ôr"], emoji: "üçÇ" },
      { q: "Telefonunun arxa fonunda n…ô var?", options: ["A) √ñz selfisi ‚Äì √∂z√ºn√º sevir", "B) M…ônz…ôr…ô ‚Äì g√∂z…ôlliy…ô vurulub", "C) Heyvan ‚Äì heyvansev…ôrdir", "D) Qara ekran ‚Äì sad…ôliyi sevir", "E) Musiqi qrupu ‚Äì fanatdƒ±r", "F) S…ônin ≈ü…ôklin ‚Äì s…ôni √∂n plana √ßƒ±xarƒ±r"], emoji: "üì±" },
      { q: "∆èn sevdiyi heyvan hansƒ±dƒ±r?", options: ["A) Pi≈üik ‚Äì evd…ôki …ôn yax≈üƒ± dost", "B) ƒ∞t ‚Äì sadiq v…ô enerjili", "C) Qu≈ü ‚Äì azadlƒ±q simvolu", "D) At ‚Äì g√ºc v…ô z…ôriflik", "E) Panda ‚Äì ≈üirin v…ô t…ônb…ôl", "F) Delfin ‚Äì aƒüƒ±llƒ± v…ô oynaq"], emoji: "üê±" },
      { q: "∆èn √ßox sevdiyi i√ßki n…ôdir?", options: ["A) Kola ‚Äì klassik v…ô enerji ver…ôn", "B) √áay ‚Äì sakitl…ô≈üdirici v…ô …ôn…ôn…ôvi", "C) Kofe ‚Äì g√ºn√ºn ba≈ülanƒüƒ±cƒ±", "D) ≈ûir…ô ‚Äì t…ôbii v…ô saƒülam", "E) Su ‚Äì sad…ô v…ô t…ômiz", "F) Limonad ‚Äì s…ôrin v…ô tur≈ü"], emoji: "ü•§" },
      { q: "U≈üaqlƒ±qda hansƒ± idman n√∂v√º il…ô m…ô≈üƒüul olub?", options: ["A) Futbol ‚Äì komanda ruhu", "B) √úzg√º√ß√ºl√ºk ‚Äì azadlƒ±q hissi", "C) R…ôqs ‚Äì ritm v…ô emosiya", "D) Voleybol ‚Äì √ßeviklik", "E) G√ºl…ô≈ü ‚Äì g√ºc v…ô m√ºbariz…ô", "F) He√ß biri ‚Äì idmanla arasƒ± yox idi"], emoji: "‚öΩ" },
      { q: "∆èn sevdiyi t…ôtil yeri haradƒ±r?", options: ["A) D…ôniz sahili ‚Äì qum v…ô g√ºn…ô≈ü", "B) Daƒülar ‚Äì s…ôrin hava v…ô m…ônz…ôr…ô", "C) ≈û…ôh…ôr ‚Äì h…ôyat v…ô gec…ô h…ôyatƒ±", "D) K…ônd ‚Äì sakitlik v…ô t…ôbi…ôt", "E) Xaricd…ô ‚Äì yeni m…ôd…ôniyy…ôtl…ôr", "F) Evind…ô ‚Äì …ôn rahat yer"], emoji: "üèñÔ∏è" },
      { q: "∆èn b√∂y√ºk x…ôyalƒ± n…ôdir?", options: ["A) D√ºnyanƒ± g…ôzm…ôk ‚Äì h…ôr √∂lk…ôni g√∂rm…ôk", "B) √áox pul qazanmaq ‚Äì l√ºks h…ôyat", "C) Ail…ô qurmaq ‚Äì sevgi v…ô u≈üaqlar", "D) M…ô≈ühur olmaq ‚Äì hamƒ±nƒ±n tanƒ±masƒ±", "E) √ñz biznesini qurmaq ‚Äì m√ºst…ôqillik", "F) Sakit h…ôyat s√ºrm…ôk ‚Äì stresssiz g√ºnl…ôr"], emoji: "üåü" },
      { q: "∆èn pis v…ôrdi≈üi n…ôdir?", options: ["A) Gec yatmaq ‚Äì gec…ô qu≈üudur", "B) √áox telefon istifad…ôsi ‚Äì sosial media asƒ±lƒ±lƒ±ƒüƒ±", "C) Unutqanlƒ±q ‚Äì h…ôr ≈üeyi itirir", "D) Dƒ±rnaq yem…ôk ‚Äì stress anƒ±nda", "E) Gecikm…ôk ‚Äì h…ômi≈ü…ô 5 d…ôqiq…ô gecikir", "F) √áox danƒ±≈ümamaq ‚Äì i√ßind…ô saxlayƒ±r"], emoji: "üòÖ" },
      { q: "∆èn √ßox sevdiyi emoji hansƒ±dƒ±r?", options: ["A) üòÇ ‚Äì h…ôr ≈üey…ô g√ºl√ºr", "B) ‚ù§Ô∏è ‚Äì sevgini g√∂st…ôrir", "C) üî• ‚Äì h…ôr ≈üey 'yanƒ±r'", "D) üòà ‚Äì yaramazlƒ±q anlarƒ±", "E) ü•∞ ‚Äì ≈üirinlik", "F) ü§¶‚Äç‚ôÄÔ∏è ‚Äì 'bu n…ô idi indi?'"], emoji: "üòè" },
      { q: "S…ôh…ôr yuxudan oyananda ilk n…ô d√º≈ü√ºn√ºr?", options: ["A) Kofe/√ßay ‚Äì g√ºn…ô onsuz ba≈ülamaz", "B) Telefon ‚Äì ilk i≈ü mesajlara baxmaq", "C) S…ôn ‚Äì s…ôni xatƒ±rlayƒ±r", "D) Yenid…ôn yatmaq ‚Äì yuxu onun sevgilisidir", "E) ƒ∞≈ü ‚Äì plan qurur", "F) Yem…ôk ‚Äì ac qalƒ±r"], emoji: "üõå" },
      { q: "∆èn sevdiyi zarafat n√∂v√º hansƒ±dƒ±r?", options: ["A) Qara yumor ‚Äì qaranlƒ±qdan qorxmur", "B) Sarkazm ‚Äì ironiyanƒ± sevir", "C) Klassik zarafatlar ‚Äì sad…ô v…ô t…ômiz", "D) Zarafat sevmir ‚Äì ciddi insan", "E) Dadlƒ± zarafatlar ‚Äì axmaq g√ºl√º≈ül…ôr", "F) P…ôd…ôr≈ü…ôkilli ‚Äì yaramazlƒ±q"], emoji: "ü§°" },
      { q: "Onun ideal h…ôft…ôsonu nec…ô ke√ßir?", options: ["A) Evd…ô film izl…ôm…ôk ‚Äì rahat v…ô isti", "B) √á√∂l…ô √ßƒ±xmaq ‚Äì mac…ôra axtarƒ±r", "C) Yuxu √ß…ôkm…ôk ‚Äì yuxu onun sevdiyi ≈üeydir", "D) Dostlarla g√∂r√º≈ü ‚Äì s√∂hb…ôt v…ô g√ºl√º≈ü", "E) Alƒ±≈ü-veri≈ü ‚Äì √∂z√ºn…ô baxmaq", "F) T…ôbi…ôtd…ô g…ôzm…ôk ‚Äì t…ômizlik v…ô s√ºkut"], emoji: "üõãÔ∏è" },
      { q: "∆èn sevdiyi kitab janrƒ± hansƒ±dƒ±r?", options: ["A) Roman ‚Äì sevgi v…ô h…ôyat hekay…ôl…ôri", "B) Detektiv ‚Äì sirri a√ßmaƒüƒ± sevir", "C) Fantastika ‚Äì x…ôyallara qa√ßƒ±r", "D) Psixologiya ‚Äì √∂z√ºn√º anlamaq", "E) He√ß oxumur ‚Äì kitab onun d√º≈üm…ônidir", "F) ≈ûeir ‚Äì ruhu ox≈üayƒ±r"], emoji: "üìö" },
      { q: "U≈üaqlƒ±qda …ôn sevdiyi cizgi filmi hansƒ± idi?", options: ["A) ≈ûrek ‚Äì ironiya v…ô yumor", "B) Aslan Kral ‚Äì emosional v…ô epik", "C) Donanma ‚Äì mac…ôra v…ô dostluq", "D) Tom v…ô Cerri ‚Äì klassik g√ºl√º≈ü", "E) SpongeBob ‚Äì axmaq v…ô …ôyl…ônc…ôli", "F) Dig…ôr ‚Äì √∂z√ºn√ºnk√º de"], emoji: "üì∫" },
      { q: "∆èn √ßox sevdiyi qoxu hansƒ±dƒ±r?", options: ["A) ∆ètir ‚Äì √∂z√ºn…ô baxƒ±mlƒ±dƒ±r", "B) Yaƒüƒ±≈üdan sonra torpaq ‚Äì t…ôbi…ôt qoxusu", "C) T…ôz…ô √ß√∂r…ôk ‚Äì ev qoxusu", "D) D…ôniz ‚Äì azadlƒ±q hissi", "E) Kofe ‚Äì s…ôh…ôr ritualƒ±", "F) G√ºl ‚Äì romantika"], emoji: "üåπ" },
      { q: "∆èn √ßox sevdiyi r…ôqs n√∂v√º hansƒ±dƒ±r?", options: ["A) Latin ‚Äì ehtiraslƒ± v…ô isti", "B) Hip-hop ‚Äì enerjili v…ô g…ônc", "C) Vals ‚Äì klassik v…ô romantik", "D) R…ôqs etmir ‚Äì utancaqdƒ±r", "E) Folklor ‚Äì k√∂kl…ôr…ô baƒülƒ±dƒ±r", "F) Tango ‚Äì intim v…ô g√ºcl√º"], emoji: "üíÉ" },
      { q: "∆èn sevdiyi r…ông kombinasiyasƒ± hansƒ±dƒ±r?", options: ["A) Qara-aƒü ‚Äì minimalist v…ô ≈üƒ±k", "B) Qƒ±rmƒ±zƒ±-qara ‚Äì ehtiras v…ô g√ºc", "C) Mavi-aƒü ‚Äì sakit v…ô t…ômiz", "D) Ya≈üƒ±l-q…ôhv…ôyi ‚Äì t…ôbi…ôt tonlarƒ±", "E) √á…ôhrayƒ±-boz ‚Äì yum≈üaq v…ô ≈üirin", "F) Dig…ôr ‚Äì √∂z√ºn√ºnk√º de"], emoji: "üåà" },
      { q: "U≈üaqlƒ±qda …ôn √ßox sevdiyi ≈üirniyyat n…ô idi?", options: ["A) ≈ûokolad ‚Äì h…ômi≈ü…ô …ôlind…ô", "B) Konfet ‚Äì r…ôngli v…ô ≈üirin", "C) Tort ‚Äì ad g√ºn√º sevinci", "D) Dondurma ‚Äì yay g√ºnl…ôrinin xo≈üb…ôxtliyi", "E) Pi≈ümi≈ü x…ômir ‚Äì ev qoxusu", "F) Qoz-fƒ±ndƒ±q ‚Äì saƒülam v…ô dadlƒ±"], emoji: "üç´" },
      { q: "∆èn √ßox sevdiyi idman n√∂v√ºn√º izl…ôm…ôyi sevir?", options: ["A) Futbol ‚Äì h…ôy…ôcan v…ô komanda", "B) Basketbol ‚Äì s√ºr…ôt v…ô bacarƒ±q", "C) Tennis ‚Äì f…ôrdi m√ºbariz…ô", "D) Formula 1 ‚Äì adrenalin v…ô s√ºr…ôt", "E) Boks ‚Äì g√ºc v…ô irad…ô", "F) He√ß izl…ômir ‚Äì idman onun i≈üi deyil"], emoji: "üèÄ" },
      { q: "∆èn sevdiyi bayram hansƒ±dƒ±r?", options: ["A) Yeni il ‚Äì yeni ba≈ülanƒüƒ±clar", "B) Novruz ‚Äì t…ôz…ôlik v…ô bahar", "C) Ad g√ºn√º ‚Äì √∂z√º m…ôrk…ôzd…ô", "D) Sevgilil…ôr g√ºn√º ‚Äì romantika", "E) Qurban bayramƒ± ‚Äì ail…ô v…ô payla≈üma", "F) M√ºst…ôqillik g√ºn√º ‚Äì v…ôt…ônp…ôrv…ôrlik"], emoji: "üéâ" },
      { q: "∆èn √ßox sevdiyi hava ≈ü…ôraiti nec…ôdir?", options: ["A) G√ºn…ô≈üli ‚Äì enerji verir", "B) Yaƒüƒ±≈ülƒ± ‚Äì romantik v…ô sakit", "C) Qarlƒ± ‚Äì sehrli v…ô t…ômiz", "D) S…ôrin k√ºl…ôkli ‚Äì rahat", "E) ƒ∞sti yay g√ºn√º ‚Äì d…ôniz v…ô istirah…ôt", "F) Payƒ±z yarpaqlarƒ± ‚Äì g√∂z…ôl m…ônz…ôr…ô"], emoji: "‚õÖ" },
      { q: "∆èn sevdiyi sosial ≈ü…ôb…ôk…ô hansƒ±dƒ±r?", options: ["A) Instagram ‚Äì ≈ü…ôkill…ôr v…ô estetika", "B) TikTok ‚Äì qƒ±sa v…ô …ôyl…ônc…ôli videolar", "C) Telegram ‚Äì s√ºr…ôtli v…ô gizli", "D) Facebook ‚Äì k√∂hn…ô dostlar", "E) Twitter/X ‚Äì fikir m√ºbadil…ôsi", "F) He√ß istifad…ô etmir ‚Äì real h…ôyatƒ± sevir"], emoji: "üì±" }
    ];

    startBtn.addEventListener('click', () => {
      startScreen.style.display = 'none';
      music.play().catch(e => console.log("Mahnƒ± oxumadƒ±:", e));
      lobby.style.display = 'block';
      status.style.display = 'block';
      status.innerHTML = 'Kod yarat v…ô ya qar≈üƒ± t…ôr…ôfin kodunu yazaraq qo≈üul!';
    });

    function createHost() {
      peer = new Peer();
      peer.on('open', id => {
        myId = id;
        myRole = 'host';
        status.innerHTML = `Host KOD: <strong>${id}</strong><br>Qar≈üƒ± t…ôr…ôf…ô g√∂nd…ôr!`;
        const copyBtn = document.createElement('button');
        copyBtn.id = 'copyBtn';
        copyBtn.textContent = 'Kopyala';
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(myId).then(() => alert('KOD kopyalandƒ±!'));
        };
        status.appendChild(copyBtn);
        lobby.querySelector('button[onclick="createHost()"]').disabled = true;
      });

      peer.on('connection', connection => {
        conn = connection;
        conn.on('open', () => {
          status.innerHTML = 'Baƒülantƒ± quruldu! Oyun ba≈ülayƒ±r...';
          lobby.style.display = 'none';
          gameDiv.style.display = 'flex';
          timerEl.style.display = 'block';
          qEmoji.style.display = 'block';
          questionEl.style.display = 'block';
          optionsEl.style.display = 'grid';
          nextQuestion();
        });
        conn.on('data', handleData);
      });
    }

    function joinGame() {
      const hostId = document.getElementById('peerIdInput').value.trim();
      if (!hostId) return alert('KOD yaz!');

      peer = new Peer();
      peer.on('open', () => {
        conn = peer.connect(hostId);
        conn.on('open', () => {
          status.innerHTML = 'Qo≈üuldun! Oyun ba≈ülayƒ±r...';
          lobby.style.display = 'none';
          gameDiv.style.display = 'flex';
          timerEl.style.display = 'block';
          qEmoji.style.display = 'block';
          questionEl.style.display = 'block';
          optionsEl.style.display = 'grid';
          nextQuestion();
        });
        conn.on('data', handleData);
      });
    }

    function handleData(data) {
      if (data.type === 'next') {
        currentQuestionIndex = data.index;
        myAnswered = false;
        opponentAnswered = false;
        showQuestion();
      } else if (data.type === 'answered') {
        if (data.player !== myRole) {
          opponentAnswered = true;
          checkBothAnswered();
        }
      } else if (data.type === 'restart') {
        opponentRestartRequested = true;
        checkRestart();
      }
    }

    function nextQuestion() {
      currentQuestionIndex++;
      if (currentQuestionIndex >= questions.length) {
        showEndScreen();
        return;
      }

      myAnswered = false;
      opponentAnswered = false;

      if (myRole === 'host') {
        conn.send({ type: 'next', index: currentQuestionIndex });
      }
      showQuestion();
    }

    function showQuestion() {
      const q = questions[currentQuestionIndex];
      qEmoji.textContent = q.emoji;
      questionEl.textContent = q.q;
      optionsEl.innerHTML = '';
      q.options.forEach((opt, i) => {
        const div = document.createElement('div');
        div.className = 'option';
        div.textContent = opt;
        div.onclick = () => selectAnswer(i);
        optionsEl.appendChild(div);
      });
      timeLeft = 15;
      timerEl.textContent = timeLeft;
      clearInterval(timerInterval);
      timerInterval = setInterval(updateTimer, 1000);
    }

    function updateTimer() {
      if (myAnswered && opponentAnswered) return;
      timeLeft--;
      timerEl.textContent = timeLeft;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        timerEl.textContent = "VAQT Bƒ∞TDƒ∞!";
        setTimeout(nextQuestion, 1800);
      }
    }

    function selectAnswer(index) {
      if (myAnswered) return;
      myAnswered = true;
      myAnswers[currentQuestionIndex] = index;
      conn.send({ type: 'answered', player: myRole });
      optionsEl.children[index].classList.add('selected');
      checkBothAnswered();
    }

    function checkBothAnswered() {
      if (myAnswered && opponentAnswered) {
        clearInterval(timerInterval);
        timerEl.textContent = "Hazƒ±r!";
        setTimeout(nextQuestion, 1500);
      }
    }

    function showEndScreen() {
      clearInterval(timerInterval);
      gameDiv.style.display = 'none';
      endDiv.style.display = 'flex';

      resultEl.innerHTML = "30 sual cavablandƒ±!";

      // Premium stil siyahƒ± ‚Äì sual + cavab
      answersList.innerHTML = '<h3 style="text-align:center; color:#ff66cc; margin-bottom:3vh; font-size:1.8rem; text-shadow:0 0 10px #ff66cc80;">‚ù§Ô∏è S…ônin Cavablarƒ±n ‚ù§Ô∏è</h3>';
      questions.forEach((q, i) => {
        const ans = myAnswers[i] === -1 ? "Cavab verm…ôdin" : q.options[myAnswers[i]];
        const div = document.createElement('div');
        div.innerHTML = `
          <strong style="font-size:1.4rem; color:#ffcc66;">Sual ${i+1}:</strong><br>
          <span style="color:#e0ccff; font-weight:500;">${q.q}</span><br><br>
          <strong style="color:#ff99ff;">Cavabƒ±n:</strong> <span style="color:#ffffff;">${ans}</span>
        `;
        answersList.appendChild(div);
      });

      document.getElementById('shareResultImage').onclick = shareResultImage;
    }

    function shareResultImage() {
      html2canvas(document.getElementById('end'), { backgroundColor: null }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'sevgili-testi-netice.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
        alert('N…ôtic…ô ≈ü…ôkli y√ºkl…ôndi! Payla≈üa bil…ôrs…ôn ‚ù§Ô∏è');
      });
    }

    function requestRestart() {
      restartRequested = true;
      if (myRole === 'host') conn.send({ type: 'restart' });
      checkRestart();
    }

    function checkRestart() {
      if (restartRequested && opponentRestartRequested) {
        myAnswers = new Array(questions.length).fill(-1);
        currentQuestionIndex = -1;
        endDiv.style.display = 'none';
        gameDiv.style.display = 'flex';
        waitingEl.textContent = '';
        nextQuestion();
      } else {
        waitingEl.textContent = opponentRestartRequested 
          ? "R…ôqib yenid…ôn ba≈ülamaƒüƒ± ist…ôyir... S…ôn d…ô bas!" 
          : "R…ôqibin d…ô basmasƒ±nƒ± g√∂zl…ôyirik...";
      }
    }
  </script>
</body>
</html>